extends ../../layout/default.pug

block main 


  - if (messages.successStatus)
    div(
      class="notifications" 
      data-status="success" 
      data-mess= messages.successStatus[0]
    )

  - if (messages.successDelete)
    div(
      class="notifications" 
      data-status="warning" 
      data-mess=messages.successDelete[0]
    )

  - if (message.successEdit.length > 0)
    div(
      class="notifications" 
      data-status="success" 
      data-mess=message.successEdit[0]
    )

  - if (message.successCreate)
    div(
      class="notifications" 
      data-status="success" 
      data-mess=message.successCreate[0]
    )
    
  h1.title #{title}


  .container-fluid.pt-2
    // FILTER START
    .card.shadow-css.p-3.mb-5
      form(action='' form-filter)
        .card-body
          h2.card-title.pb-3 Filter
          .row
            .col-4
              label.form-label(for='filter-name') Filter name: 
              input.form-control(type='text' placeholder="Input name ..." id="filter-name")
            .col-4
              label.form-label(for='filter-active') Filter active: 
              select.form-select(name='' id='filter-active')
                option(value="") All
                option(value="active") Active 
                option(value="inactive") Inactive   
            .col-4
              label.form-label(for='filter-sort') Filter sort: 
              select.form-select(name='' id='filter-sort')
                option(value="") Sort 
                option(value="fullName-desc") Sắp xếp theo tên (A-Z) 
                option(value="fullName-asc") Sắp xếp theo tên (Z-A)
                option(value="createdAt-desc") Thời gian tạo mới nhất
                option(value="createdAt-asc") Thời gian tạo lâu nhất
          .row.mt-2
            .col-3
              button.btn.btn-primary(type="submit" btn-filter)
                <i class="fa-solid fa-filter mr-1" style="border: none"></i> Filter
    // FILTER END
    // LIST PRODUCTS START
    .card.shadow-css.p-3.mb-5
      .card-body
        h2.card-title.pb-3 List Accounts
        .row
          .col-6
            .input-group
              input.form-control(type='file')
              button.btn.btn-success  + Import
              button.btn.btn-secondary  - Export
          .col-1
          .col-4
            form(
              action=`${prefixAdmin}/accounts/change-multi?_method=PATCH`
              method="POST"
              form-change-multi
            )
              .input-group
                select.form-select(name='type' id='')
                  option(disable selected) Choose active
                  option(value="active") Active 
                  option(value="inactive") Inactive 
                  option(value="delete") Delete
                input(
                  type="text"
                  name="ids"
                  value=""
                  class="form-control"
                  class="d-none"
                )
                button.btn.btn-primary(type="submit") Apply Action 
          .col-1
            a.btn.btn-primary(href=`${prefixAdmin}/accounts/create`)  + New
        .row.p-2.mt-3
          table.table-css.mb-5(checkbox-multi)
            thead
              tr
                td 
                  input(type="checkbox" name="checkall")
                td(scope='col') #
                td(scope='col') Avatar
                td(scope='col') Full Name
                td(scope='col') Role
                td(scope="col") Email
                td(scope='col') Create At
                td(scope='col') Status
                td(scope='col') Action
            tbody
              each item, index in accounts
                tr 
                  td 
                    input(type="checkbox" name="id" value=item.id)
                  th(scope='row' style="padding: 0px 20px") #{index + 1}
                  td 
                    img(src=item.avatar width='100px' class="img-thumbnail")
                  td #{item.fullName}
                  td #{item.roleId.title}
                  td=item.email
                  td #{moment(item.createdAt).format("DD/MM/YYYY HH:mm")}
                  td 
                    if(item.status == "active")
                      a(
                        href="javascript:;" 
                        btn-change-status
                        itemStatus=item.status 
                        itemId=item.id
                        class='badge badge-success p-2'
                        style="font-size: 0.9rem"
                      ) Active
                    else 
                      a(
                        href="javascript:;" 
                        btn-change-status
                        itemStatus=item.status 
                        itemId=item.id
                        class='badge badge-danger p-2'
                        style="font-size: 0.9rem"
                      ) Inactive
                  td  
                    a(
                        href=`${prefixAdmin}/accounts/read/${item.id}`
                        class='btn btn-primary btn-sm p-2 m-2'
                        style="font-size: 0.9rem"
                        data-bs-toggle="tooltip" 
                        data-bs-placement="top" 
                        data-bs-offset="0,10"
                        data-bs-custom-class="custom-tooltip"
                        title="Read"
                    ) <i class="fa-brands fa-readme"></i>
                    a(
                      href=`${prefixAdmin}/accounts/edit/${item.id}`
                      class='btn btn-warning btn-sm p-2 m-2'
                      style="font-size: 0.9rem"
                      data-bs-toggle="tooltip" 
                      data-bs-placement="top" 
                      data-bs-offset="0,10"
                      data-bs-custom-class="custom-tooltip"
                      title="Edit"
                    ) <i class="fa-solid fa-pen-to-square"></i>
                    button(
                      class='btn btn-danger btn-sm p-2 m-2'
                      button-delete
                      data-id=item.id
                      style="font-size: 0.9rem"
                      data-bs-toggle="tooltip" 
                      data-bs-placement="top"
                      data-bs-offset="0,10"
                      data-bs-custom-class="custom-tooltip"
                      title="Delete"
                    ) <i class="fa-regular fa-trash"></i>
                    


        .row
          .col-10
            nav(aria-label='Page navigation example')
              ul.pagination
                li.page-item
                  button.page-link(page-pagination=pagination.currentPage-1)
                    span(aria-hidden='true') &laquo;
                - for(let i = 1; i <= pagination.totalPage; i ++) 
                  li(class=`page-item ${pagination.currentPage == i ? "active" : ""}`)
                    button.page-link(page-pagination=i) #{i}
                li.page-item
                  button.page-link(page-pagination=pagination.currentPage+1)
                    span(aria-hidden='true') &raquo;
          .col
            form(
              action=""
              form-number-items-page
            )
              select.form-select(name='numberItemPage' select-number-items-page)
                - for (let i = 4; i <= 10; i += 2)
                  option(value=i selected=(pagination.limitItem == i ? true : false)) #{i} items per page

  form(
    action=""
    method="POST"
    id = 'form-change-status'
    data-path = `${prefixAdmin}/accounts/change-status`
  ) 

  form(
    action=""
    method="POST"
    id = 'form-delete'
    data-path = `${prefixAdmin}/accounts/delete-account`
  ) 
              
    // LIST PRODUCTS END
  script(src="/js/admin/filter.js")
  script(src="/js/admin/pagination.js")
  script(src="/js/admin/changePosition.js")
  script(src="/js/admin/changeStatus.js")
  script(src="/js/admin/deleteProduct.js")

