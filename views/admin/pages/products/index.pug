extends ../../layout/default.pug
include ../../mixins/filterStatus.pug
include ../../mixins/search.pug

block main 

  - if(messages.success)
      div(
        class="alert alert-success"
        data-time=3000
        show-alert
      ) #{messages.success}

  h1 Trang danh sách sản phẩm

  .card.mb-3 
    .card-header Bộ lọc và tìm kiếm 
    .card-body 
      .row 
        .col-6 
          +filterStatus(filterStatus)
        .col-6 
          +search()


  .card.mb-3 
    .card-header Danh sách
    .card-body 
      form(
        action=`${prefixAdmin}/products/change-multi?_method=PATCH`
        method="POST"
        form-change-multi
      ) 
        .d-flex.align-items-start 
          .form-group 
            select(
              name="type"
              class="form-control"
            )
              option(disable selected) Choose active
              option(value="active") Active 
              option(value="inactive") Inactive 
              option(value="delete") Delete
              option(value="position") Sort postion 
          .form-group 
            input(
              type="text"
              name="ids"
              value=""
              class="form-control"
              style="display:none"
            )    
          button(
            type="submit"
            class="btn btn-primary"
          ) Áp dụng

      table(
        class="table table-hover"
        checkbox-multi
      )
        thead 
          tr 
            th 
              input(type="checkbox" name="checkall")
            th(scope='col') STT 
            th(scope='col') Hình ảnh
            th(scope='col') Tiêu đề
            th(scope='col') Giá 
            th(scope='col') Vị trí
            th(scope='col') Trạng thái 
            th(scope='col') Hành động 

        tbody 
          each item, index in products
            tr 
              td 
                input(type="checkbox" name="id" value=item.id)
              th(scope='row') #{index + 1}
              td  
                img(src=item.thumbnail, alt="")
              td=item.title
              td=item.price
              td  
                input(
                  type="number"
                  min="1"
                  name="position"
                  value=item.position
                  style="width: 50px"
                )
              td 
                if(item.status == "active")
                  a(
                    href="javascript:;" 
                    btn-change-status
                    itemStatus=item.status 
                    itemId=item.id
                    class='badge badge-success'
                  ) Hoạt động
                else 
                  a(
                    href="javascript:;" 
                    btn-change-status
                    itemStatus=item.status 
                    itemId=item.id
                    class='badge badge-danger'
                  ) Dừng hoạt động
              td  
                button(class='btn btn-warning btn-sm') Sửa
                button(
                  class='btn btn-danger btn-sm'
                  button-delete
                  data-id=item.id
                  ) Xoá
    .card-footer
      nav(aria-label="Page navigation example")
        ul.pagination 
          li.page-item 
            button(class="page-link" page-pagination=pagination.currentPage-1) Previous 
          - for(let i = 1; i <= pagination.totalPage; i ++)
            li(class=`page-item ${pagination.currentPage == i ? "active" : ""}`) 
              button(class="page-link" page-pagination=i) #{i}
          li.page-item 
            button(class="page-link" page-pagination=pagination.currentPage+1) Next

  form(
    action=""
    method="POST"
    id = 'form-change-status'
    data-path = `${prefixAdmin}/products/change-status`
  ) 

  form(
    action=""
    method="POST"
    id = 'form-delete-product'
    data-path = `${prefixAdmin}/products/delete-product`
  ) 



  script(src="/js/admin/changeStatus.js") 
  script(src="/js/admin/deleteProduct.js") 
  script(src="/js/admin/alert.js") 